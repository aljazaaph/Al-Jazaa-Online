<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Al-Jazaa Ph</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- SweetAlert2 (Elegant Popups) -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        :root {
            --primary: #1b4d3e; /* Elegant Green */
            --primary-dark: #123329;
            --gold: #D4AF37;
            --bg-color: #EBEBE9; /* Warm Grey */
            --text: #333;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text); 
            overflow-x: hidden; 
        }
        
        h1, h2, h3, h4, h5, .navbar-brand { font-family: 'Playfair Display', serif; }

        /* Announcement Bar */
        .announcement-bar { background-color: var(--primary-dark); color: var(--gold); text-align: center; font-size: 0.85rem; padding: 10px 0; letter-spacing: 1.5px; text-transform: uppercase; }

        /* Navbar */
        .navbar { background-color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.05); padding: 15px 0; }
        .navbar-brand { font-weight: 700; font-size: 1.6rem; color: var(--primary) !important; letter-spacing: -0.5px; }
        .nav-link { color: #555 !important; font-weight: 500; transition: 0.3s; margin: 0 10px; font-size: 0.95rem; }
        .nav-link:hover { color: var(--primary) !important; }
        .cart-badge { background-color: var(--gold); color: white; border-radius: 50%; padding: 2px 7px; font-size: 0.75rem; position: relative; top: -5px; }

        /* Carousel */
        .carousel-item { position: relative; }
        .carousel-item::after { content:""; display:block; position:absolute; top:0; bottom:0; left:0; right:0; background:rgba(0,0,0,0.3); }
        .carousel-item img { height: 60vh; object-fit: cover; }
        .carousel-caption { bottom: 20%; z-index: 2; }
        .carousel-caption h5 { font-size: 2.5rem; text-shadow: 0 2px 10px rgba(0,0,0,0.5); color: #fff; margin-bottom: 15px; }
        .btn-hero { background: white; color: var(--primary); padding: 12px 30px; font-weight: bold; border: none; margin-top: 15px; transition:0.3s; }
        .btn-hero:hover { background: var(--gold); color: white; }

        /* Sidebar & Layout */
        .cat-sidebar { position: sticky; top: 100px; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); }
        .cat-btn { display: block; width: 100%; text-align: left; padding: 12px 0; border: none; background: none; color: #666; transition: 0.3s; border-bottom: 1px solid #f0f0f0; font-size: 1rem; }
        .cat-btn:hover, .cat-btn.active { color: var(--primary); font-weight: bold; padding-left: 10px; }

        /* Product Cards */
        .product-card { 
            border: none; background: white; transition: all 0.3s ease; cursor: pointer; border-radius: 20px;
            overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); height: 100%;
        }
        .product-card:hover { transform: translateY(-7px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
        .card-img-top { height: 280px; object-fit: cover; border-bottom: 1px solid #f8f8f8; }
        .stock-label { position: absolute; top: 15px; right: 15px; padding: 5px 12px; font-size: 0.7rem; color: white; font-weight: 700; text-transform: uppercase; border-radius: 50px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 2; }
        .in-stock { background-color: var(--primary); }
        .out-stock { background-color: #999; }

        /* Size Selection Boxes */
        .slant-box {
            display: inline-block; border: 1px solid #ddd; padding: 10px 20px; margin: 5px; font-size: 0.9rem;
            transform: skewX(-15deg); cursor: pointer; transition: all 0.2s ease; background: white; color: #555;
            min-width: 60px; text-align: center;
        }
        .slant-box span { display: block; transform: skewX(15deg); font-weight: 600; }
        .slant-box:hover { border-color: var(--primary); background: #f9f9f9; }
        .slant-box.selected { background-color: var(--primary); color: white; border-color: var(--primary); }

        /* Overlay */
        #detail-view { position: fixed; inset: 0; background: #fff; z-index: 2000; overflow-y: auto; display: none; padding-bottom: 50px; }
        
        /* UI Elements */
        .btn-custom { background-color: var(--primary); color: white; border-radius: 8px; padding: 14px 25px; text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px; transition: 0.3s; border: none; font-weight: 600; }
        .btn-custom:hover { background-color: var(--primary-dark); color: white; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(27, 77, 62, 0.3); }
        .btn-custom:disabled { background-color: #ccc; box-shadow: none; transform: none; }
        .form-control { padding: 12px; border-radius: 8px; border: 1px solid #ddd; background: #fdfdfd; }
        .form-control:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(27, 77, 62, 0.1); }

        /* Accordion Footer */
        footer { background-color: var(--primary-dark); color: #ccc; padding-top: 50px; margin-top: 60px; }
        .accordion-item { background: transparent; border: none; border-bottom: 1px solid #334e46; }
        .accordion-button { background: transparent; color: var(--gold); font-family: 'Playfair Display'; font-size: 1.1rem; box-shadow: none; }
        .accordion-button:not(.collapsed) { background: rgba(0,0,0,0.2); color: white; box-shadow: none; }
        .accordion-body { color: #aaa; font-size: 0.9rem; }
        .footer-social a { color: var(--gold); margin: 0 10px; transition: 0.3s; }
        .footer-social a:hover { color: white; }

        /* Loader */
        #loader { position: fixed; inset: 0; background: rgba(255,255,255,0.98); z-index: 9999; display: flex; justify-content: center; align-items: center; flex-direction: column; }
    </style>
</head>
<body>

<script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwrIc8z0ZTOKWaDMaB_EXTJYgxO6TCS7LfjhyiR7lW6hEBlvqHUvASnp1PDd4tqM-3Q/exec"; // PASTE SCRIPT URL HERE
</script>

<div id="loader">
    <div class="spinner-border text-success" role="status" style="width: 3rem; height: 3rem;"></div>
    <h3 class="mt-4" style="color:var(--primary); font-family: 'Playfair Display';">Al-Jazaa Ph.</h3>
</div>

<div class="announcement-bar">Authentic Quality • Cash on Delivery / GCash • Nationwide Shipping</div>

<nav class="navbar navbar-expand-lg sticky-top">
    <div class="container">
        <a class="navbar-brand" href="#" onclick="routeTo('home')">Al-Jazaa Ph.</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navContent">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navContent">
            <ul class="navbar-nav ms-auto align-items-center">
                <li class="nav-item"><a class="nav-link" href="#" onclick="routeTo('home')">Shop</a></li>
                <li class="nav-item"><a class="nav-link" href="#" onclick="routeTo('track')">Track Order</a></li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="routeTo('cart')">
                        <i class="fas fa-shopping-bag fa-lg"></i>
                        <span id="cart-count" class="cart-badge">0</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- === HOMEPAGE === -->
<div id="page-home">
    <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://images.unsplash.com/photo-1496747611176-843222e1e57c?q=80&w=2073&auto=format&fit=crop" class="d-block w-100" alt="Fashion 1">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Timeless Modesty</h5>
                    <button class="btn-hero" onclick="scrollToProducts()">SHOP NOW</button>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=2070&auto=format&fit=crop" class="d-block w-100" alt="Fashion 2">
                <div class="carousel-caption d-none d-md-block">
                    <h5>New Collection</h5>
                </div>
            </div>
        </div>
    </div>

    <div class="container my-5" id="shop-section">
        <div class="row">
            <div class="col-lg-3 mb-4">
                <div class="cat-sidebar">
                    <h5 class="mb-4 text-uppercase fw-bold" style="color:var(--primary); font-size: 0.9rem;">Collections</h5>
                    <div id="category-list"></div>
                </div>
            </div>
            <div class="col-lg-9">
                <h2 class="mb-4" style="font-family:'Playfair Display'">Latest Products</h2>
                <input type="text" id="searchBox" class="form-control mb-4" placeholder="Search..." onkeyup="doSearch()">
                <div class="row g-4" id="product-grid"></div>
            </div>
        </div>
    </div>
</div>

<!-- === DETAIL VIEW === -->
<div id="detail-view">
    <div class="container py-5">
        <button class="btn btn-outline-secondary mb-4 rounded-pill px-4" onclick="window.history.back()">
            <i class="fas fa-arrow-left me-2"></i> Back
        </button>
        <div class="row gx-5">
            <div class="col-md-6 mb-4">
                <img id="dt-img" src="" class="img-fluid rounded-4 shadow-sm w-100" style="max-height:600px; object-fit:cover;">
            </div>
            <div class="col-md-6">
                <small class="text-uppercase text-muted" id="dt-cat"></small>
                <h1 id="dt-name" class="display-5 fw-bold mt-2"></h1>
                <h2 id="dt-price" class="text-success mb-4 fw-bold"></h2>
                <p id="dt-desc" class="lead fs-6 text-secondary mb-4"></p>
                <hr class="my-4">
                <div class="mb-3"><label class="fw-bold">Size</label><div id="size-area" class="d-flex flex-wrap gap-2"></div></div>
                <div class="mb-3"><label class="fw-bold">Height</label><input type="text" id="height-input" class="form-control" placeholder="e.g. 5'5 or 165cm"></div>
                <button id="add-btn" class="btn btn-custom w-100 py-3 mt-2 shadow-lg" onclick="addToCart()">ADD TO CART</button>
            </div>
        </div>
    </div>
</div>

<!-- === CART === -->
<div id="page-cart" class="container my-5 d-none">
    <h2 class="mb-4">Your Cart</h2>
    <div class="row">
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm rounded-4 mb-4"><div class="table-responsive"><table class="table mb-0"><tbody id="cart-table"></tbody></table></div></div>
        </div>
        <div class="col-lg-4">
            <div class="card p-4 shadow-sm border-0 rounded-4">
                <h4>Summary</h4><hr>
                <div class="d-flex justify-content-between mb-4"><span class="fs-5">Total:</span><span class="fw-bold text-success fs-4" id="cart-total">₱0.00</span></div>
                <button class="btn btn-custom w-100 py-3" onclick="routeTo('checkout')">CHECKOUT</button>
            </div>
        </div>
    </div>
</div>

<!-- === CHECKOUT === -->
<div id="page-checkout" class="container my-5 d-none" style="max-width: 800px;">
    <div class="card p-5 shadow-lg border-0 rounded-4">
        <h2 class="text-center mb-4">Checkout</h2>
        <form onsubmit="submitOrder(event)">
            <h5 class="text-success fw-bold">1. Shipping Info</h5>
            <div class="row g-3 mb-4">
                <div class="col-md-6"><label>Full Name</label><input type="text" class="form-control" id="c-name" required></div>
                <div class="col-md-6"><label>Phone</label><input type="number" class="form-control" id="c-phone" required></div>
                <div class="col-12"><label>Email Address (For Tracking)</label><input type="email" class="form-control" id="c-email" required></div>
                <div class="col-12"><label>Address</label><textarea class="form-control" id="c-addr" rows="3" required></textarea></div>
            </div>
            
            <h5 class="text-success fw-bold">2. Payment (GCash)</h5>
            <div class="alert alert-danger shadow-sm mb-3">
                <i class="fas fa-exclamation-circle me-2"></i> <strong>IMPORTANT:</strong> Please pay the EXACT amount first before submitting!
            </div>
            <div class="alert alert-success border-0 rounded-3 shadow-sm mb-3">
                <div class="d-flex align-items-center mb-2">
                    <i class="fas fa-qrcode fa-2x me-3"></i>
                    <div><div class="fw-bold">Send to GCash</div><div class="fs-5">09XX-XXX-XXXX</div><div class="small">Al-Jazaa Business</div></div>
                </div>
                <hr>
                <div class="d-flex justify-content-between"><strong>Total to Pay:</strong><strong id="pay-total" class="fs-5"></strong></div>
            </div>
            <div class="mb-3">
                <label>Reference Number</label><input type="text" class="form-control" id="c-ref" required>
            </div>
            <div class="mb-4">
                <label>Upload Payment Screenshot</label>
                <input type="file" class="form-control" id="c-proof" accept="image/*" required>
                <div class="form-text">We must verify your payment to process the order.</div>
            </div>
            <button type="submit" class="btn btn-custom w-100 py-3">PLACE ORDER</button>
        </form>
    </div>
</div>

<!-- === TRACKING === -->
<div id="page-track" class="container my-5 d-none text-center" style="max-width:600px; min-height:50vh;">
    <h2>Track Order</h2>
    <div class="input-group mb-4 mt-3">
        <input type="text" id="track-id" class="form-control" placeholder="Enter Order ID">
        <button class="btn btn-custom" onclick="trackOrder()">Search</button>
    </div>
    <div id="track-result" class="card p-4 shadow border-0 rounded-4 d-none text-start">
        <h4 class="text-success text-center" id="t-status"></h4>
        <div class="mt-3"><p><strong>Date:</strong> <span id="t-date"></span></p><p><strong>Total:</strong> <span id="t-total"></span></p></div>
    </div>
</div>

<!-- FOOTER -->
<footer>
    <div class="container pb-4">
        <div class="text-center mb-5">
            <h2 style="font-family:'Playfair Display'; color:white; font-size: 2.5rem;">Al-Jazaa Ph.</h2>
            <div class="footer-social mt-3">
                <a href="#"><i class="fab fa-facebook fa-lg"></i></a>
                <a href="#"><i class="fab fa-instagram fa-lg"></i></a>
                <a href="#"><i class="fab fa-tiktok fa-lg"></i></a>
            </div>
        </div>
        
        <div class="accordion" id="footerAccordion" style="max-width: 800px; margin: 0 auto;">
            <div class="accordion-item">
                <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1">Payment Policy</button></h2>
                <div id="collapse1" class="accordion-collapse collapse" data-bs-parent="#footerAccordion"><div class="accordion-body">We accept Cash on Delivery and GCash. For GCash, strict verification is required via screenshot upload. Unpaid GCash orders will be cancelled after 24 hours.</div></div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2">Delivery Policy</button></h2>
                <div id="collapse2" class="accordion-collapse collapse" data-bs-parent="#footerAccordion"><div class="accordion-body">Standard shipping takes 3-5 days for Metro Manila and 5-10 days for Provincial areas. Shipping fees are calculated at checkout based on location.</div></div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3">Contact Us</button></h2>
                <div id="collapse3" class="accordion-collapse collapse" data-bs-parent="#footerAccordion"><div class="accordion-body">Email: admin@aljazaa.ph<br>Phone: 0912-345-6789<br>Mon-Fri, 9AM - 5PM</div></div>
            </div>
        </div>
        <p class="text-center small mt-5">&copy; 2024 Al-Jazaa Ph. All rights reserved.</p>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // DATA & STATE
    let allProducts = [];
    let cart = JSON.parse(localStorage.getItem('alj_cart_v4')) || [];
    let curProduct = {}, selectedSize = null;

    // INIT
    document.addEventListener("DOMContentLoaded", () => {
        fetchProducts();
        updateCartCount();
        generateSizes();
        
        // Handle Back Button Logic
        window.history.replaceState({ page: 'home' }, '', ''); // Init history
        window.onpopstate = function(event) {
            if (event.state) {
                renderPage(event.state.page, false);
            }
        };
    });

    // --- NAVIGATION LOGIC ---
    function routeTo(pageId) {
        // Push state to history so back button works
        window.history.pushState({ page: pageId }, '', '');
        renderPage(pageId);
    }

    function renderPage(pageId, pushDetailClose = true) {
        // Hide All Pages
        ['page-home', 'page-cart', 'page-checkout', 'page-track'].forEach(id => {
            document.getElementById(id).classList.add('d-none');
        });
        document.getElementById('detail-view').style.display = 'none';
        document.getElementById('heroCarousel').classList.add('d-none');
        window.scrollTo(0,0);

        // Show Requested Page
        if(pageId === 'home') {
            document.getElementById('page-home').classList.remove('d-none');
            document.getElementById('heroCarousel').classList.remove('d-none');
        } else {
            document.getElementById('page-' + pageId).classList.remove('d-none');
        }

        if(pageId === 'cart') renderCart();
        if(pageId === 'checkout') {
            document.getElementById('pay-total').innerText = document.getElementById('cart-total').innerText;
        }
    }

    function scrollToProducts() { document.getElementById('shop-section').scrollIntoView({behavior: 'smooth'}); }

    // --- DATA ---
    function fetchProducts() {
        fetch(WEB_APP_URL + "?action=getProducts")
            .then(r => r.json())
            .then(data => {
                allProducts = data;
                document.getElementById('loader').style.display = 'none';
                renderCats();
                renderProds(allProducts);
            });
    }

    function renderCats() {
        const cats = ['All', ...new Set(allProducts.map(p => p.category))];
        document.getElementById('category-list').innerHTML = cats.map(c => `<button class="cat-btn ${c==='All'?'active':''}" onclick="filterCat('${c}', this)">${c}</button>`).join('');
    }
    function renderProds(list) {
        document.getElementById('product-grid').innerHTML = list.map(p => `
            <div class="col-md-4 col-sm-6 mb-4">
                <div class="card product-card" onclick="openDetail('${p.id}')">
                    <span class="stock-label ${p.inStock?'in-stock':'out-stock'}">${p.inStock?'In Stock':'Out of Stock'}</span>
                    <img src="${p.image}" class="card-img-top">
                    <div class="card-body text-center"><h5 class="fw-bold">${p.name}</h5><p class="text-success fw-bold">₱${p.price}</p></div>
                </div>
            </div>`).join('');
    }
    function filterCat(cat, btn) {
        document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderProds(cat === 'All' ? allProducts : allProducts.filter(p => p.category === cat));
    }

    // --- DETAILS ---
    function openDetail(id) {
        window.history.pushState({ page: 'detail' }, '', ''); // Back button support
        curProduct = allProducts.find(p => p.id == id);
        selectedSize = null;
        
        document.querySelectorAll('.slant-box').forEach(el => el.classList.remove('selected'));
        document.getElementById('height-input').value = "";
        
        document.getElementById('dt-img').src = curProduct.image;
        document.getElementById('dt-cat').innerText = curProduct.category;
        document.getElementById('dt-name').innerText = curProduct.name;
        document.getElementById('dt-price').innerText = "₱" + curProduct.price;
        document.getElementById('dt-desc').innerText = curProduct.desc;

        const btn = document.getElementById('add-btn');
        btn.disabled = !curProduct.inStock;
        btn.innerText = curProduct.inStock ? "ADD TO CART" : "OUT OF STOCK";
        
        document.getElementById('detail-view').style.display = 'block';
    }

    function generateSizes() {
        document.getElementById('size-area').innerHTML = ["S","M","L","XL","XXL"].map(s => `<div class="slant-box" onclick="pickSize('${s}', this)"><span>${s}</span></div>`).join('');
    }
    function pickSize(val, el) {
        document.querySelectorAll('.slant-box').forEach(b => b.classList.remove('selected'));
        el.classList.add('selected');
        selectedSize = val;
    }

    function addToCart() {
        const hVal = document.getElementById('height-input').value.trim();
        if(!selectedSize || !hVal) {
            Swal.fire({ icon: 'warning', title: 'Details Missing', text: 'Please select a Size and enter your Height.', confirmButtonColor: '#1b4d3e'});
            return;
        }
        cart.push({ ...curProduct, size: selectedSize, height: hVal, qty: 1 });
        saveCart();
        Swal.fire({ icon: 'success', title: 'Added!', text: 'Item added to your cart.', timer: 1500, showConfirmButton: false });
        window.history.back(); // Go back to shop
    }

    // --- CART ---
    function saveCart() { localStorage.setItem('alj_cart_v4', JSON.stringify(cart)); updateCartCount(); }
    function updateCartCount() { document.getElementById('cart-count').innerText = cart.length; }
    function renderCart() {
        let total = 0;
        document.getElementById('cart-table').innerHTML = cart.length === 0 ? '<tr><td class="text-center py-5">Cart Empty</td></tr>' : cart.map((i,x) => {
            total += (i.price * 1);
            return `<tr><td><img src="${i.image}" width="50" class="rounded"></td><td><div class="fw-bold">${i.name}</div><small>Sz:${i.size} | Ht:${i.height}</small></td><td class="text-success fw-bold">₱${i.price}</td><td class="text-end"><i class="fas fa-trash text-danger" style="cursor:pointer" onclick="delItem(${x})"></i></td></tr>`;
        }).join('');
        document.getElementById('cart-total').innerText = "₱" + total;
    }
    function delItem(i) { cart.splice(i,1); saveCart(); renderCart(); }

    // --- ORDER & FILE HANDLING ---
    function submitOrder(e) {
        e.preventDefault();
        const fileInput = document.getElementById('c-proof');
        if(fileInput.files.length === 0) return;

        Swal.fire({
            title: 'Submitting Order...',
            text: 'Please wait while we upload your payment proof.',
            allowOutsideClick: false,
            didOpen: () => { Swal.showLoading() }
        });

        // Convert File to Base64
        const file = fileInput.files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
            const base64Data = e.target.result;
            const payload = {
                action: 'placeOrder',
                cust: {
                    name: document.getElementById('c-name').value,
                    phone: document.getElementById('c-phone').value,
                    email: document.getElementById('c-email').value,
                    addr: document.getElementById('c-addr').value
                },
                pay: {
                    ref: document.getElementById('c-ref').value,
                    image: base64Data, // Send Image Data
                    mime: file.type
                },
                cart: cart,
                total: document.getElementById('cart-total').innerText
            };
            
            sendData(payload);
        };
        reader.readAsDataURL(file);
    }

    function sendData(payload) {
        fetch(WEB_APP_URL, { method: 'POST', body: JSON.stringify(payload) })
        .then(res => res.json())
        .then(data => {
            if(data.status === 'success') {
                cart = []; saveCart();
                Swal.fire({
                    icon: 'success',
                    title: 'Order Placed!',
                    html: `Your Order ID: <b>${data.orderId}</b><br>We sent the details to your email.`,
                    confirmButtonColor: '#1b4d3e'
                }).then(() => { routeTo('home'); });
            } else {
                Swal.fire({ icon: 'error', title: 'Error', text: 'Something went wrong.' });
            }
        })
        .catch(err => Swal.fire({ icon: 'error', title: 'Network Error', text: 'Please check connection.' }));
    }

    function trackOrder() {
        const id = document.getElementById('track-id').value.trim();
        if(!id) return;
        document.getElementById('loader').style.display = 'flex';
        fetch(WEB_APP_URL + `?action=trackOrder&orderId=${id}`)
        .then(r => r.json())
        .then(data => {
            document.getElementById('loader').style.display = 'none';
            document.getElementById('track-result').classList.remove('d-none');
            if(data.status === 'found') {
                document.getElementById('t-status').innerText = data.currStatus;
                document.getElementById('t-date').innerText = data.date;
                document.getElementById('t-total').innerText = "₱" + data.total;
            } else {
                document.getElementById('t-status').innerText = "Order Not Found";
                document.getElementById('t-date').innerText = "-";
            }
        });
    }
</script>
</body>
</html>
